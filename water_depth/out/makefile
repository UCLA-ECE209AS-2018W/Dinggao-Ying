# ###*B*###
#
# ERIKA Enterprise - a tiny RTOS for small microcontrollers
# 
# Copyright (C) 2002-2017 Evidence Srl
# 
# This file is part of ERIKA Enterprise.
# 
# See LICENSE file.
#
# ###*E*###

############################################################################
#
# This file is generated by RT-Druid.
# Please do not modify it.
#
############################################################################

############################################################################
#
# Version Check
#
############################################################################
OS_EE_RTD_GEN_VERSION:=12345

export	OS_EE_RTD_GEN_VERSION

############################################################################
#
# Automatic options
#
############################################################################
ifneq ($(if $(filter OS_EE_RTD_BUILD_ENV_%,$(OS_EE_OPT)),yes,), yes)
OS_EE_OPT += OS_EE_RTD_BUILD_ENV_NATIVE
endif	# OS_EE_RTD_BUILD_ENV_%
export OS_EE_OPT


############################################################################
#
# Application base directory
#
############################################################################
OS_EE_APP_BASE_DIR := ..

export OS_EE_APP_BASE_DIR

OS_EE_APP_OUT_DIR := .

export OS_EE_APP_OUT_DIR


############################################################################
#
# Erika Enterprise base directory
#
############################################################################
ifdef OS_EE_BASE_DIR
$(warning OS_EE_BASE_DIR is set, but will be overridden)
endif # OS_EE_BASE_DIR

OS_EE_BASE_DIR := $(strip $(abspath $(OS_EE_APP_BASE_DIR)/erika))
export OS_EE_BASE_DIR


############################################################################
#
# Sources
#
############################################################################
OS_EE_APP_CFG_SRCS += ee_applcfg.c
OS_EE_APP_CFG_SRCS += code.cpp
OS_EE_APP_CFG_SRCS += mcp_can.cpp
OS_EE_APP_CFG_SRCS += SPI.cpp

export OS_EE_APP_CFG_SRCS


############################################################################
#
# Main Rules
#
############################################################################
.PHONY: all clean docs

all:    $(OS_EE_BASE_DIR)/mk/ee.mk $(OS_EE_BASE_DIR)/lib
	@$(MAKE) -f $(OS_EE_BASE_DIR)/mk/ee.mk all

clean:  $(OS_EE_BASE_DIR)/mk/ee.mk
	@$(MAKE) -f $(OS_EE_BASE_DIR)/mk/ee.mk clean

$(OS_EE_BASE_DIR)/lib:
	@$(MAKE) -C $(OS_EE_BASE_DIR) all

$(OS_EE_BASE_DIR)/mk/ee.mk:
	@$(MAKE) -C $(OS_EE_BASE_DIR) mk

docs: $(OS_EE_BASE_DIR)/mk/ee.mk
	@$(MAKE) -C $(OS_EE_BASE_DIR)/doc docs


export  ARDUINO_PORT        = /dev/ttyACM1
export  ARDUINO_BAUDRATE    = 11520
export  ARDUINO_MCU         = atmega328p
export  ARDUINO_SDK_FILES   = /home/yvonne/Downloads/arduino-1.8.5

ifeq    ($(shell uname), Linux)
export  ARDUINO_PHY_PORT = /dev/$(ARDUINO_PORT)
else    # Linux
export  ARDUINO_PHY_PORT = \\\\.\\$(ARDUINO_PORT)
endif   # Linux

PHONY: upload

upload:
	@$(ARDUINO_SDK_FILES)/hardware/tools/avr/bin/avrdude \
	-C$(ARDUINO_SDK_FILES)/hardware/tools/avr/etc/avrdude.conf \
	-p$(ARDUINO_MCU) -carduino -P$(ARDUINO_PORT) \
	-b$(ARDUINO_BAUDRATE) -D -Uflash:w:arduino.hex:i


############################################################################
#
# End
#
############################################################################
